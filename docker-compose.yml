django:
    restart: always
    build: ./django
    volumes:
        - /srv/django/static
    expose:
        - "8000"
    environment:
        DJANGO_SETTINGS_MODULE: project.settings.prod
    links:
        - db:db
        - rabbitmq:rabbitmq

celery:
    build: ./django
    volumes_from:
        - django
    expose:
        - "8000"
    environment:
        DJANGO_SETTINGS_MODULE: project.settings.prod
    links:
        - db:db
        - rabbitmq:rabbitmq
    command: ./manage.py celery worker -l warning

nginx:
    build: ./nginx
    ports:
        - "8080:80"
    links:
        - django:django
    volumes_from:
        - django
        - react

react:
    build: ./react
    volumes:
        - /srv/react/dist

db:
    image: postgres

rabbitmq:
    image: rabbitmq:3.6
    environment:
        RABBITMQ_DEFAULT_USER: user
        RABBITMQ_DEFAULT_PASS: password
